{"ast":null,"code":"import React,{useState,useEffect}from'react';import{CheckCircle,AlertCircle,Loader2,RefreshCw,Lock,PlusCircle,BarChart3,Users,History,Download,Calendar,Building,UserPlus,LogOut}from'lucide-react';// Define getApiBaseUrl outside components so it can be reused\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const getApiBaseUrl=()=>{const hostname=window.location.hostname;if(hostname==='localhost'||hostname==='127.0.0.1'){return'http://localhost:5000/api';}return`http://${hostname}:5000/api`;};// Main App Component\nconst App=()=>{const[isAdmin,setIsAdmin]=useState(false);const[token,setToken]=useState(localStorage.getItem('token')||'');const[userLevel,setUserLevel]=useState(2);const[username,setUsername]=useState('');// Verify token on initial load\nuseEffect(()=>{if(token){verifyToken(token);}},[token]);const verifyToken=async token=>{try{const API_BASE_URL=getApiBaseUrl();const response=await fetch(`${API_BASE_URL}/admin/me`,{headers:{'Authorization':`Bearer ${token}`}});if(response.ok){const data=await response.json();setUserLevel(data.userLevel);setUsername(data.username);setIsAdmin(true);// Set isAdmin to true when token is valid\n}else{handleLogout();}}catch(err){handleLogout();console.error('Token verification failed:',err);}};const handleLoginSuccess=(token,userData)=>{localStorage.setItem('token',token);setToken(token);setUserLevel(userData.userLevel);setUsername(userData.username);setIsAdmin(true);};const handleLogout=()=>{localStorage.removeItem('token');setToken('');setUserLevel(2);setUsername('');setIsAdmin(false);};if(isAdmin){return/*#__PURE__*/_jsx(AdminDashboard,{onLogout:handleLogout,userLevel:userLevel,username:username});}else{return/*#__PURE__*/_jsx(SurveyUserPanel,{onAdminLogin:handleLoginSuccess});}};// User Panel Component - Fixed admin login handling\nconst SurveyUserPanel=_ref=>{let{onAdminLogin}=_ref;const[question,setQuestion]=useState(null);const[department,setDepartment]=useState('');const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[submitted,setSubmitted]=useState(false);const[submitting,setSubmitting]=useState(false);const[departmentSlug,setDepartmentSlug]=useState('');const[countdown,setCountdown]=useState(3);const[selectedEmoji,setSelectedEmoji]=useState(null);const[showAdminLogin,setShowAdminLogin]=useState(false);const[loginForm,setLoginForm]=useState({username:'',password:''});const[loginError,setLoginError]=useState('');const[loginLoading,setLoginLoading]=useState(false);const[clickCount,setClickCount]=useState(0);const[showAdminButton,setShowAdminButton]=useState(false);const API_BASE_URL=getApiBaseUrl();// Function to read slug from text file\nconst readSlugFromFile=async()=>{try{const response=await fetch(`${API_BASE_URL}/get-slug`);if(response.ok){const data=await response.json();return data.slug||'';}return'';}catch(err){console.error('Failed to read slug file:',err);return'';}};useEffect(()=>{const extractSlugFromUrl=async()=>{const pathname=window.location.pathname;const urlParts=pathname.split('/').filter(part=>part.length>0);let slug='';if(urlParts.length===0){slug=await readSlugFromFile();}else if(urlParts.length===1){slug=urlParts[0];}else{slug=urlParts[urlParts.length-1];}slug=slug.split('?')[0].split('#')[0];return slug||(await readSlugFromFile());};const initializeSlug=async()=>{const slug=await extractSlugFromUrl();setDepartmentSlug(slug);};initializeSlug();},[]);const emojiOptions=[{id:1,emoji:'ðŸ˜',label:'Excellent',color:'bg-green-100 border-green-300 hover:bg-green-200'},{id:2,emoji:'ðŸ˜Š',label:'Good',color:'bg-blue-100 border-blue-300 hover:bg-blue-200'},{id:3,emoji:'ðŸ˜',label:'Okay',color:'bg-yellow-100 border-yellow-300 hover:bg-yellow-200'},{id:4,emoji:'ðŸ˜ž',label:'Poor',color:'bg-orange-100 border-orange-300 hover:bg-orange-200'},{id:5,emoji:'ðŸ˜¡',label:'Terrible',color:'bg-red-100 border-red-300 hover:bg-red-200'}];useEffect(()=>{let interval;if(submitted&&countdown>0){interval=setInterval(()=>{setCountdown(prev=>prev-1);},1000);}else if(submitted&&countdown===0){window.location.reload();}return()=>{if(interval)clearInterval(interval);};},[submitted,countdown]);const handlePanelClick=()=>{const newCount=clickCount+1;setClickCount(newCount);if(newCount>=5){setShowAdminButton(true);}};const loadActiveQuestion=async slug=>{if(!slug)return;try{setLoading(true);setError('');const response=await fetch(`${API_BASE_URL}/departments/${slug}/active-question`,{method:'GET',headers:{'Accept':'application/json','Content-Type':'application/json'}});if(!response.ok){if(response.status===404){throw new Error(`No active survey found for department: ${slug}`);}else if(response.status===500){throw new Error('Server error occurred. Please try again.');}else if(!navigator.onLine){throw new Error('No internet connection. Please check your network.');}else{throw new Error(`Unable to load survey (Error: ${response.status})`);}}const data=await response.json();setQuestion(data);const deptName=slug.replace(/-/g,' ').replace(/\\b\\w/g,l=>l.toUpperCase());setDepartment(deptName);}catch(err){console.error('Failed to load question:',err);if(err.name==='TypeError'&&err.message.includes('fetch')){setError('Cannot connect to survey server. Please check if the server is running and accessible.');}else{setError(err.message);}}finally{setLoading(false);}};const submitAnswer=async emojiOption=>{if(!question||submitting)return;try{setSubmitting(true);setSelectedEmoji(emojiOption.id);setError('');const response=await fetch(`${API_BASE_URL}/questions/${question.QuestionID}/answers`,{method:'POST',headers:{'Content-Type':'application/json','Accept':'application/json'},body:JSON.stringify({emoji:emojiOption.emoji,emojiId:emojiOption.id})});if(!response.ok){let errorMessage='Failed to submit answer';try{const errorData=await response.json();errorMessage=errorData.error||errorMessage;}catch(parseError){if(response.status===500){errorMessage='Server error occurred while submitting';}else if(response.status===404){errorMessage='Survey question not found';}else{errorMessage=`Submit failed (Error: ${response.status})`;}}throw new Error(errorMessage);}const result=await response.json();setSubmitted(true);setCountdown(3);}catch(err){console.error('Failed to submit answer:',err);if(err.name==='TypeError'&&err.message.includes('fetch')){setError('Cannot connect to survey server to submit your response.');}else{setError(err.message);}setSelectedEmoji(null);}finally{setSubmitting(false);}};useEffect(()=>{if(departmentSlug){loadActiveQuestion(departmentSlug);}},[departmentSlug]);const handleRetry=()=>{setError('');setSelectedEmoji(null);loadActiveQuestion(departmentSlug);};// Fixed admin login handler\nconst handleAdminLogin=async e=>{e.preventDefault();setLoginLoading(true);setLoginError('');try{const response=await fetch(`${API_BASE_URL}/admin/login`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(loginForm)});if(response.ok){const data=await response.json();// Call the parent's onAdminLogin with token and user data\nonAdminLogin(data.token,data);}else{const errorData=await response.json();throw new Error(errorData.error||'Login failed');}}catch(err){setLoginError(err.message);}finally{setLoginLoading(false);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Loader2,{className:\"w-16 h-16 text-white animate-spin mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 w-16 h-16 border-4 border-white border-opacity-20 rounded-full mx-auto animate-pulse\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-xl font-medium\",children:\"Loading survey...\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-white text-sm opacity-75 mt-2\",children:[\"Department: \",departmentSlug]})]})});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 flex items-center justify-center cursor-pointer\",onClick:handlePanelClick,children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-white bg-opacity-95 backdrop-blur-sm rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-gray-800 mb-4\",children:\"Welcome!\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4 text-gray-600\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-lg\",children:\"Thank you for visiting our feedback system\"}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-50 border-2 border-blue-200 rounded-xl p-4\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"font-medium text-blue-800 mb-2\",children:[department||departmentSlug.replace(/-/g,' ').replace(/\\b\\w/g,l=>l.toUpperCase()),\" Department\"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 text-sm\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u2728 Your feedback matters to us\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\uD83C\\uDFAF Help us improve our services\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\uD83D\\uDC9D Thank you for your patience\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 space-y-4\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:handleRetry,className:\"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-all duration-200 flex items-center justify-center mx-auto gap-2\",children:[/*#__PURE__*/_jsx(RefreshCw,{className:\"w-4 h-4\"}),\"Check for Updates\"]}),showAdminButton&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowAdminLogin(!showAdminLogin),className:\"fixed top-4 right-4 z-50 overflow-hidden bg-blue-600 text-white px-4 py-2 rounded-full hover:bg-blue-700 transition-all duration-200 flex items-center gap-2 shadow-lg animate-pulse\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"relative z-10 flex items-center gap-1\"}),/*#__PURE__*/_jsx(Lock,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Admin\"})]})]}),showAdminLogin&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 pt-4 border-t border-gray-200\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-800 mb-3\",children:\"Admin Login\"}),loginError&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-3 p-2 bg-red-100 text-red-700 rounded-md text-sm\",children:loginError}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleAdminLogin,children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Username\",value:loginForm.username,onChange:e=>setLoginForm({...loginForm,username:e.target.value}),className:\"w-full p-2 border rounded-md text-sm\",required:true})}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Password\",value:loginForm.password,onChange:e=>setLoginForm({...loginForm,password:e.target.value}),className:\"w-full p-2 border rounded-md text-sm\",required:true})}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loginLoading,className:\"w-full py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 disabled:bg-gray-400 text-sm\",children:loginLoading?'Logging in...':'Login'})]})]})]})})});}// Success state with countdown\nif(submitted){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gradient-to-br from-green-900 via-green-800 to-green-900 flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-white bg-opacity-95 backdrop-blur-sm rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-20 h-20 text-green-500 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-gray-800 mb-2\",children:\"Thank You!\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-2\",children:\"Your feedback has been submitted successfully.\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500 mb-6\",children:[\"Department: \",department]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-green-50 border-2 border-green-200 rounded-xl p-4 mb-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-green-700 font-medium mb-2\",children:\"Waiting for next employee\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"relative\",children:/*#__PURE__*/_jsx(Loader2,{className:\"w-6 h-6 text-green-600 animate-spin mr-2\"})}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-green-600 font-semibold text-lg\",children:[\"Refreshing in \",countdown,\"...\"]})]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-400\",children:\"The page will automatically refresh for the next person\"})]})})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 relative overflow-hidden\",onClick:handlePanelClick,children:[showAdminButton&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowAdminLogin(!showAdminLogin),className:\"fixed top-4 right-4 z-50 overflow-hidden bg-blue-600 text-white px-4 py-2 rounded-full hover:bg-blue-700 transition-all duration-200 flex items-center gap-2 shadow-lg animate-pulse\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"relative z-10 flex items-center gap-1\"}),/*#__PURE__*/_jsx(Lock,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Admin\"})]}),showAdminLogin&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-xl p-6 max-w-md w-full\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800\",children:\"Admin Login\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowAdminLogin(false),className:\"text-gray-500 hover:text-gray-700\",children:\"\\xD7\"})]}),loginError&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 bg-red-100 text-red-700 rounded-md text-sm\",children:loginError}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleAdminLogin,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-medium mb-1\",children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:loginForm.username,onChange:e=>setLoginForm({...loginForm,username:e.target.value}),className:\"w-full p-2 border rounded-md\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-medium mb-1\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:loginForm.password,onChange:e=>setLoginForm({...loginForm,password:e.target.value}),className:\"w-full p-2 border rounded-md\",required:true})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loginLoading,className:\"w-full py-2 px-4 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400\",children:loginLoading?'Logging in...':'Login'})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute inset-0 overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute -top-1/2 -left-1/2 w-full h-full bg-gradient-to-br from-blue-500 to-purple-600 opacity-20 rounded-full animate-pulse\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute -bottom-1/2 -right-1/2 w-full h-full bg-gradient-to-tl from-purple-500 to-indigo-600 opacity-20 rounded-full animate-pulse\",style:{animationDelay:'3s'}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"relative z-10 max-w-4xl mx-auto px-4 py-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-2xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-5xl font-bold text-white mb-2 drop-shadow-lg\",children:\"Happiness Survey\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-white text-2xl drop-shadow-md opacity-90\",children:[department,\" Department\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-20 h-1 bg-white bg-opacity-50 mx-auto mt-4 rounded-full\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white bg-opacity-95 backdrop-blur-sm rounded-2xl shadow-2xl p-8 border border-white border-opacity-50 relative overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-semibold text-gray-800 mb-4 text-center leading-relaxed\",children:question===null||question===void 0?void 0:question.QuestionText}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-center\",children:\"Please select your response:\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-5 gap-4 mb-6\",children:emojiOptions.map(option=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>submitAnswer(option),disabled:submitting,className:`\n                    flex flex-col items-center p-6 rounded-xl border-2 transition-all duration-300 \n                    transform hover:scale-105 hover:shadow-lg active:scale-95\n                    ${submitting&&selectedEmoji===option.id?'scale-95 opacity-75':''}\n                    ${option.color}\n                    disabled:cursor-not-allowed\n                    focus:outline-none focus:ring-4 focus:ring-blue-300\n                  `,children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-5xl mb-3 select-none\",children:option.emoji}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-700 font-medium\",children:option.label}),submitting&&selectedEmoji===option.id&&/*#__PURE__*/_jsx(Loader2,{className:\"w-4 h-4 text-gray-600 animate-spin mt-2\"})]},option.id))}),submitting&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center mb-2\",children:[/*#__PURE__*/_jsx(Loader2,{className:\"w-6 h-6 text-blue-600 animate-spin mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-700 font-medium\",children:\"Submitting your response...\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-32 h-2 bg-gray-200 rounded-full mx-auto overflow-hidden\",children:/*#__PURE__*/_jsx(\"div\",{className:\"h-full bg-blue-600 rounded-full animate-pulse\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center text-sm text-gray-500 mt-6\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"mb-1\",children:\"Click on any emoji to submit your feedback\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs\",children:\"Your response is anonymous and helps us improve our services\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center mt-8\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-white text-sm drop-shadow-md opacity-75\",children:\"Thank you for taking the time to share your feedback\"})})]})})]});};// Admin Dashboard Component\nconst AdminDashboard=_ref2=>{let{onLogout,userLevel,username}=_ref2;const[activeTab,setActiveTab]=useState(userLevel===1?'departments':'questions');const[departments,setDepartments]=useState([]);const[questions,setQuestions]=useState([]);const[newDepartment,setNewDepartment]=useState('');const[newQuestion,setNewQuestion]=useState('');const[selectedDepartment,setSelectedDepartment]=useState('');const[reports,setReports]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState('');const[historyData,setHistoryData]=useState([]);const[filteredData,setFilteredData]=useState([]);const[selectedDepartmentForHistory,setSelectedDepartmentForHistory]=useState('');const[startDate,setStartDate]=useState('');const[endDate,setEndDate]=useState('');const[exportLoading,setExportLoading]=useState(false);const[success,setSuccess]=useState('');const[registerForm,setRegisterForm]=useState({username:'',password:'',confirmPassword:'',userLevel:2});const getApiBaseUrl=()=>{const hostname=window.location.hostname;if(hostname==='localhost'||hostname==='127.0.0.1'){return'http://localhost:5000/api';}return`http://${hostname}:5000/api`;};const API_BASE_URL=getApiBaseUrl();const loadDepartments=async()=>{try{setLoading(true);const response=await fetch(`${API_BASE_URL}/departments`);if(!response.ok){throw new Error(`HTTP error! status: ${response.status}`);}const data=await response.json();setDepartments(Array.isArray(data)?data:[]);setError('');}catch(err){console.error('Failed to load departments:',err);setDepartments([]);setError('Failed to load departments: '+err.message);}finally{setLoading(false);}};const loadQuestions=async()=>{try{setLoading(true);const response=await fetch(`${API_BASE_URL}/questions`);if(!response.ok){throw new Error(`HTTP error! status: ${response.status}`);}const data=await response.json();setQuestions(Array.isArray(data)?data:[]);setError('');}catch(err){console.error('Failed to load questions:',err);setQuestions([]);setError('Failed to load questions: '+err.message);}finally{setLoading(false);}};const loadHistoryData=async function(){let departmentId=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';let startDate=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'';let endDate=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'';try{setLoading(true);let url=`${API_BASE_URL}/reports/history`;const params=new URLSearchParams();if(departmentId)params.append('departmentId',departmentId);if(startDate)params.append('startDate',startDate);if(endDate)params.append('endDate',endDate);if(params.toString()){url+=`?${params.toString()}`;}const response=await fetch(url);if(!response.ok){throw new Error(`HTTP error! status: ${response.status}`);}const data=await response.json();setHistoryData(Array.isArray(data)?data:[]);setFilteredData(Array.isArray(data)?data:[]);setError('');}catch(err){console.error('Failed to load history data:',err);setHistoryData([]);setFilteredData([]);setError('Failed to load history data: '+err.message);}finally{setLoading(false);}};const updateDepartment=async(id,newName)=>{try{setLoading(true);setError('');setSuccess('');const response=await fetch(`${API_BASE_URL}/departments/${id}`,{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify({name:newName.trim()})});if(response.ok){setSuccess('Department updated successfully!');setTimeout(()=>setSuccess(''),3000);await loadDepartments();}else{const errorData=await response.json();throw new Error(errorData.error||'Failed to update department');}}catch(err){setError(err.message);}finally{setLoading(false);}};const deleteDepartment=async id=>{if(!window.confirm('Are you sure you want to delete this department? This cannot be undone.')){return;}try{setLoading(true);setError('');setSuccess('');const response=await fetch(`${API_BASE_URL}/departments/${id}`,{method:'DELETE'});if(response.ok){setSuccess('Department deleted successfully!');setTimeout(()=>setSuccess(''),3000);await loadDepartments();}else{const errorData=await response.json();throw new Error(errorData.error||'Failed to delete department');}}catch(err){setError(err.message);}finally{setLoading(false);}};const exportToExcel=async()=>{try{var _departments$find;setExportLoading(true);let url=`${API_BASE_URL}/reports/export`;const params=new URLSearchParams();if(selectedDepartmentForHistory)params.append('departmentId',selectedDepartmentForHistory);if(startDate)params.append('startDate',startDate);if(endDate)params.append('endDate',endDate);if(params.toString()){url+=`?${params.toString()}`;}const response=await fetch(url);if(!response.ok){throw new Error(`Export failed: ${response.status}`);}const blob=await response.blob();const downloadUrl=window.URL.createObjectURL(blob);const link=document.createElement('a');link.href=downloadUrl;const now=new Date();const dateStr=now.toISOString().split('T')[0];const deptName=selectedDepartmentForHistory?((_departments$find=departments.find(d=>d.DepartmentID==selectedDepartmentForHistory))===null||_departments$find===void 0?void 0:_departments$find.Name)||'Selected':'All';link.download=`Survey_Report_${deptName}_${dateStr}.xlsx`;document.body.appendChild(link);link.click();document.body.removeChild(link);window.URL.revokeObjectURL(downloadUrl);}catch(err){console.error('Export failed:',err);setError('Export failed: '+err.message);}finally{setExportLoading(false);}};const handleFilterChange=()=>{loadHistoryData(selectedDepartmentForHistory,startDate,endDate);};const loadReports=async()=>{try{setLoading(true);const response=await fetch(`${API_BASE_URL}/reports`);if(!response.ok){throw new Error(`HTTP error! status: ${response.status}`);}const data=await response.json();const processedReports=data.map(report=>{const emojiCounts={1:0,// Excellent\n2:0,// Good\n3:0,// Okay\n4:0,// Poor\n5:0// Terrible\n};if(report.responses&&Array.isArray(report.responses)){report.responses.forEach(response=>{const emojiId=response.EmojiID;if(emojiCounts.hasOwnProperty(emojiId)){emojiCounts[emojiId]=response.Count||0;}});}const emojiData=[{emoji:'ðŸ˜',label:'Excellent',count:emojiCounts[1],id:1},{emoji:'ðŸ˜Š',label:'Good',count:emojiCounts[2],id:2},{emoji:'ðŸ˜',label:'Okay',count:emojiCounts[3],id:3},{emoji:'ðŸ˜ž',label:'Poor',count:emojiCounts[4],id:4},{emoji:'ðŸ˜¡',label:'Terrible',count:emojiCounts[5],id:5}];return{department:report.department,question:report.question,totalResponses:report.totalResponses||0,responses:report.responses||[],emojiData:emojiData};});setReports(processedReports);setError('');}catch(err){console.error('Failed to load reports:',err);setReports([]);setError('Failed to load reports: '+err.message);}finally{setLoading(false);}};const addDepartment=async()=>{if(!newDepartment.trim()){setError('Department name is required');return;}setLoading(true);setError('');setSuccess('');try{const response=await fetch(`${API_BASE_URL}/departments`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({name:newDepartment.trim()})});if(response.ok){setNewDepartment('');setSuccess('Department added successfully!');setTimeout(()=>setSuccess(''),3000);await loadDepartments();}else{const errorData=await response.json();throw new Error(errorData.error||'Failed to add department');}}catch(err){setError(err.message);}finally{setLoading(false);}};const addQuestion=async()=>{if(!selectedDepartment||!newQuestion.trim()){setError('Department and question text are required');return;}setLoading(true);setError('');setSuccess('');try{const dept=departments.find(d=>d.DepartmentID==selectedDepartment);if(!dept){throw new Error('Department not found');}const response=await fetch(`${API_BASE_URL}/departments/${dept.URLSlug}/questions`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({questionText:newQuestion.trim()})});if(response.ok){setNewQuestion('');setSelectedDepartment('');setSuccess('Question added successfully!');setTimeout(()=>setSuccess(''),3000);await loadQuestions();}else{const errorData=await response.json();throw new Error(errorData.error||'Failed to add question');}}catch(err){setError(err.message);}finally{setLoading(false);}};const handleRegister=async e=>{e.preventDefault();setLoading(true);setError('');setSuccess('');if(registerForm.password!==registerForm.confirmPassword){setError('Passwords do not match');setLoading(false);return;}try{const token=localStorage.getItem('token');const response=await fetch(`${API_BASE_URL}/admin/register`,{method:'POST',headers:{'Content-Type':'application/json','Authorization':`Bearer ${token}`},body:JSON.stringify({username:registerForm.username,password:registerForm.password,userLevel:registerForm.userLevel})});if(response.ok){setRegisterForm({username:'',password:'',confirmPassword:'',userLevel:2});setError('');setSuccess('Admin registered successfully!');setTimeout(()=>setSuccess(''),3000);}else{const errorData=await response.json();throw new Error(errorData.error||'Registration failed');}}catch(err){setError(err.message);}finally{setLoading(false);}};useEffect(()=>{loadDepartments();},[]);useEffect(()=>{if(activeTab==='questions'){loadQuestions();}else if(activeTab==='reports'){loadReports();}else if(activeTab==='history'){loadHistoryData();}},[activeTab]);return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-100\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white shadow-sm border-b\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto px-4 py-6 flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-900\",children:\"Survey Admin Dashboard\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-700\",children:[\"Logged in as: \",username]}),/*#__PURE__*/_jsxs(\"button\",{onClick:onLogout,className:\"flex items-center gap-1 px-3 py-1 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300\",children:[/*#__PURE__*/_jsx(LogOut,{className:\"w-4 h-4\"}),\"Logout\"]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto px-4 py-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4 mb-8\",children:[userLevel===1&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('departments'),className:`px-4 py-2 rounded-md font-medium ${activeTab==='departments'?'bg-blue-100 text-blue-700':'text-gray-600 hover:bg-gray-100'}`,children:\"Departments\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('questions'),className:`px-4 py-2 rounded-md font-medium ${activeTab==='questions'?'bg-blue-100 text-blue-700':'text-gray-600 hover:bg-gray-100'}`,children:\"Send Questions\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('reports'),className:`px-4 py-2 rounded-md font-medium ${activeTab==='reports'?'bg-blue-100 text-blue-700':'text-gray-600 hover:bg-gray-100'}`,children:\"Reports\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('history'),className:`px-4 py-2 rounded-md font-medium ${activeTab==='history'?'bg-blue-100 text-blue-700':'text-gray-600 hover:bg-gray-100'}`,children:\"History\"}),userLevel===1&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('admin-register'),className:`px-4 py-2 rounded-md font-medium ${activeTab==='admin-register'?'bg-blue-100 text-blue-700':'text-gray-600 hover:bg-gray-100'}`,children:\"Admin Register\"})]}),activeTab==='departments'&&userLevel===1&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-4\",children:\"Departments\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 bg-red-100 text-red-700 rounded-md\",children:error}),success&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 bg-green-100 text-green-700 rounded-md\",children:success}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newDepartment,onChange:e=>setNewDepartment(e.target.value),placeholder:\"New department name\",className:\"w-full p-2 border rounded-md\",onKeyPress:e=>e.key==='Enter'&&addDepartment()}),/*#__PURE__*/_jsx(\"button\",{onClick:addDepartment,disabled:loading,className:\"mt-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400\",children:loading?'Adding...':'Add Department'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:departments.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-center py-4\",children:\"No departments found\"}):departments.map(dept=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 border rounded-md flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium\",children:dept.Name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[\"URL: /survey/\",dept.URLSlug]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const newName=prompt('Enter new department name:',dept.Name);if(newName&&newName.trim()&&newName!==dept.Name){updateDepartment(dept.DepartmentID,newName);}},className:\"px-2 py-1 text-sm bg-yellow-100 text-yellow-800 rounded hover:bg-yellow-200\",children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteDepartment(dept.DepartmentID),className:\"px-2 py-1 text-sm bg-red-100 text-red-800 rounded hover:bg-red-200\",children:\"Delete\"})]})]},dept.DepartmentID))})]}),activeTab==='questions'&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-4\",children:\"Create Question\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 bg-red-100 text-red-700 rounded-md\",children:error}),success&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 bg-green-100 text-green-700 rounded-md\",children:success}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsxs(\"select\",{value:selectedDepartment,onChange:e=>setSelectedDepartment(e.target.value),className:\"w-full p-2 border rounded-md mb-2\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select department\"}),departments.map(dept=>/*#__PURE__*/_jsx(\"option\",{value:dept.DepartmentID,children:dept.Name},dept.DepartmentID))]}),/*#__PURE__*/_jsx(\"textarea\",{value:newQuestion,onChange:e=>setNewQuestion(e.target.value),placeholder:\"Question text\",rows:3,className:\"w-full p-2 border rounded-md\"}),/*#__PURE__*/_jsx(\"button\",{onClick:addQuestion,disabled:loading,className:\"mt-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400\",children:loading?'Adding...':'Add Question'})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold mb-2\",children:\"Current Questions\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:questions.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-center py-4\",children:\"No questions found\"}):questions.map(q=>{const dept=departments.find(d=>d.DepartmentID===q.DepartmentID);return/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 border rounded-md\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"flex-1\",children:q.QuestionText}),/*#__PURE__*/_jsx(\"span\",{className:`px-2 py-1 text-xs rounded ml-2 ${q.IsActive?'bg-green-100 text-green-800':'bg-gray-100 text-gray-800'}`,children:q.IsActive?'Active':'Inactive'})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600 mt-1\",children:[(dept===null||dept===void 0?void 0:dept.Name)||'Unknown Department',\" \\u2022 \",q.CreatedAt?new Date(q.CreatedAt).toLocaleString():'Date not available']})]},q.QuestionID);})})]}),activeTab==='reports'&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold\",children:\"Ongoing Surveys\"}),/*#__PURE__*/_jsx(\"button\",{onClick:loadReports,disabled:loading,className:\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400\",children:loading?'Refreshing...':'Refresh Data'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:reports.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 mb-4\",children:\"No reports available\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400\",children:\"Make sure you have departments with active questions and responses\"})]}):reports.map((report,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"border rounded-lg p-6 bg-gray-50\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-bold text-lg text-gray-900\",children:report.department}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700 mt-2 text-base\",children:report.question}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600 mt-1\",children:[\"Total responses: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:report.totalResponses})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg p-4 border\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium mb-4 text-gray-700\",children:\"Response Breakdown:\"}),report.totalResponses>0?/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-5 gap-4\",children:report.emojiData.map((item,j)=>{const percentage=report.totalResponses>0?(item.count/report.totalResponses*100).toFixed(1):0;return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-4xl mb-2\",children:item.emoji}),/*#__PURE__*/_jsx(\"div\",{className:\"font-bold text-2xl text-gray-800\",children:item.count}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600 font-medium\",children:[percentage,\"%\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 mt-1\",children:item.label})]},j);})}):/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-6 text-gray-500\",children:\"No responses yet for this question\"})]})]},i))})]}),activeTab==='history'&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold\",children:\"Survey History & Export\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:exportToExcel,disabled:exportLoading||filteredData.length===0,className:\"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-400\",children:[/*#__PURE__*/_jsx(Download,{className:\"w-4 h-4\"}),exportLoading?'Exporting...':'Export to Excel']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg mb-6\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"font-medium mb-4 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Building,{className:\"w-4 h-4\"}),\"Filter Options\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Department\"}),/*#__PURE__*/_jsxs(\"select\",{value:selectedDepartmentForHistory,onChange:e=>setSelectedDepartmentForHistory(e.target.value),className:\"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Departments\"}),departments.map(dept=>/*#__PURE__*/_jsx(\"option\",{value:dept.DepartmentID,children:dept.Name},dept.DepartmentID))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Start Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:startDate,onChange:e=>setStartDate(e.target.value),className:\"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"End Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:endDate,onChange:e=>setEndDate(e.target.value),className:\"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mt-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleFilterChange,disabled:loading,className:\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400\",children:loading?'Filtering...':'Apply Filters'}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setSelectedDepartmentForHistory('');setStartDate('');setEndDate('');loadHistoryData();},className:\"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600\",children:\"Clear Filters\"})]})]}),filteredData.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-50 p-4 rounded-lg mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-2\",children:[/*#__PURE__*/_jsx(BarChart3,{className:\"w-4 h-4 text-blue-600\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-blue-800\",children:\"Results Summary\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Total Records: \"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:filteredData.length})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Total Responses: \"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:filteredData.reduce((sum,item)=>sum+(item.totalResponses||0),0)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Departments: \"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:new Set(filteredData.map(item=>item.department)).size})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:loading?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-gray-600\",children:\"Loading history data...\"})]}):filteredData.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8\",children:[/*#__PURE__*/_jsx(History,{className:\"w-12 h-12 text-gray-400 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 mb-2\",children:\"No survey data found\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400\",children:\"Try adjusting your filters or create some surveys to see data here\"})]}):filteredData.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"border rounded-lg p-4 bg-gray-50\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-bold text-lg text-gray-900\",children:item.department}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700 mt-1\",children:item.question})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[\"Total Responses: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:item.totalResponses})]}),item.createdAt&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:new Date(item.createdAt).toLocaleDateString()})]})]}),item.emojiData&&item.totalResponses>0&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg p-3 border\",children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-5 gap-2\",children:item.emojiData.map((emoji,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl mb-1\",children:emoji.emoji}),/*#__PURE__*/_jsx(\"div\",{className:\"font-bold text-lg\",children:emoji.count}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-600\",children:[item.totalResponses>0?(emoji.count/item.totalResponses*100).toFixed(1):0,\"%\"]})]},i))})})]},index))})]}),activeTab==='admin-register'&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-md p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-4\",children:\"Register New Admin\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 bg-red-100 text-red-700 rounded-md\",children:error}),success&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 bg-green-100 text-green-700 rounded-md\",children:success}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleRegister,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-medium mb-2\",children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:registerForm.username,onChange:e=>setRegisterForm({...registerForm,username:e.target.value}),className:\"w-full p-2 border rounded-md\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-medium mb-2\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:registerForm.password,onChange:e=>setRegisterForm({...registerForm,password:e.target.value}),className:\"w-full p-2 border rounded-md\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-medium mb-2\",children:\"Confirm Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:registerForm.confirmPassword,onChange:e=>setRegisterForm({...registerForm,confirmPassword:e.target.value}),className:\"w-full p-2 border rounded-md\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-medium mb-2\",children:\"Admin Level\"}),/*#__PURE__*/_jsxs(\"select\",{value:registerForm.userLevel,onChange:e=>setRegisterForm({...registerForm,userLevel:parseInt(e.target.value)}),className:\"w-full p-2 border rounded-md\",children:[/*#__PURE__*/_jsx(\"option\",{value:1,children:\"Super Admin\"}),/*#__PURE__*/_jsx(\"option\",{value:2,children:\"Admin\"})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,className:\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400\",children:loading?'Registering...':'Register Admin'})]})]})]})]});};export default App;","map":{"version":3,"names":["React","useState","useEffect","CheckCircle","AlertCircle","Loader2","RefreshCw","Lock","PlusCircle","BarChart3","Users","History","Download","Calendar","Building","UserPlus","LogOut","jsx","_jsx","jsxs","_jsxs","getApiBaseUrl","hostname","window","location","App","isAdmin","setIsAdmin","token","setToken","localStorage","getItem","userLevel","setUserLevel","username","setUsername","verifyToken","API_BASE_URL","response","fetch","headers","ok","data","json","handleLogout","err","console","error","handleLoginSuccess","userData","setItem","removeItem","AdminDashboard","onLogout","SurveyUserPanel","onAdminLogin","_ref","question","setQuestion","department","setDepartment","loading","setLoading","setError","submitted","setSubmitted","submitting","setSubmitting","departmentSlug","setDepartmentSlug","countdown","setCountdown","selectedEmoji","setSelectedEmoji","showAdminLogin","setShowAdminLogin","loginForm","setLoginForm","password","loginError","setLoginError","loginLoading","setLoginLoading","clickCount","setClickCount","showAdminButton","setShowAdminButton","readSlugFromFile","slug","extractSlugFromUrl","pathname","urlParts","split","filter","part","length","initializeSlug","emojiOptions","id","emoji","label","color","interval","setInterval","prev","reload","clearInterval","handlePanelClick","newCount","loadActiveQuestion","method","status","Error","navigator","onLine","deptName","replace","l","toUpperCase","name","message","includes","submitAnswer","emojiOption","QuestionID","body","JSON","stringify","emojiId","errorMessage","errorData","parseError","result","handleRetry","handleAdminLogin","e","preventDefault","className","children","onClick","onSubmit","type","placeholder","value","onChange","target","required","disabled","style","animationDelay","QuestionText","map","option","_ref2","activeTab","setActiveTab","departments","setDepartments","questions","setQuestions","newDepartment","setNewDepartment","newQuestion","setNewQuestion","selectedDepartment","setSelectedDepartment","reports","setReports","historyData","setHistoryData","filteredData","setFilteredData","selectedDepartmentForHistory","setSelectedDepartmentForHistory","startDate","setStartDate","endDate","setEndDate","exportLoading","setExportLoading","success","setSuccess","registerForm","setRegisterForm","confirmPassword","loadDepartments","Array","isArray","loadQuestions","loadHistoryData","departmentId","arguments","undefined","url","params","URLSearchParams","append","toString","updateDepartment","newName","trim","setTimeout","deleteDepartment","confirm","exportToExcel","_departments$find","blob","downloadUrl","URL","createObjectURL","link","document","createElement","href","now","Date","dateStr","toISOString","find","d","DepartmentID","Name","download","appendChild","click","removeChild","revokeObjectURL","handleFilterChange","loadReports","processedReports","report","emojiCounts","responses","forEach","EmojiID","hasOwnProperty","Count","emojiData","count","totalResponses","addDepartment","addQuestion","dept","URLSlug","questionText","handleRegister","onKeyPress","key","prompt","rows","q","IsActive","CreatedAt","toLocaleString","i","item","j","percentage","toFixed","reduce","sum","Set","size","index","createdAt","toLocaleDateString","parseInt"],"sources":["C:/Users/dularad/Desktop/Smile1/Smile-Survey-main/admin/src/app.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { \n  CheckCircle, AlertCircle, Loader2, RefreshCw, Lock, \n  PlusCircle, BarChart3, Users, History, Download, \n  Calendar, Building, UserPlus, LogOut \n} from 'lucide-react';\n\n// Define getApiBaseUrl outside components so it can be reused\nconst getApiBaseUrl = () => {\n  const hostname = window.location.hostname;\n  if (hostname === 'localhost' || hostname === '127.0.0.1') {\n    return 'http://localhost:5000/api';\n  }\n  return `http://${hostname}:5000/api`;\n};\n\n// Main App Component\nconst App = () => {\n  const [isAdmin, setIsAdmin] = useState(false);\n  const [token, setToken] = useState(localStorage.getItem('token') || '');\n  const [userLevel, setUserLevel] = useState(2);\n  const [username, setUsername] = useState('');\n  \n  // Verify token on initial load\n  useEffect(() => {\n    if (token) {\n      verifyToken(token);\n    }\n  }, [token]);\n  \n  const verifyToken = async (token) => {\n    try {\n      const API_BASE_URL = getApiBaseUrl();\n      const response = await fetch(`${API_BASE_URL}/admin/me`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      \n      if (response.ok) {\n        const data = await response.json();\n        setUserLevel(data.userLevel);\n        setUsername(data.username);\n        setIsAdmin(true); // Set isAdmin to true when token is valid\n      } else {\n        handleLogout();\n      }\n    } catch (err) {\n      handleLogout();\n      console.error('Token verification failed:', err);\n    }\n  };\n  \n  const handleLoginSuccess = (token, userData) => {\n    localStorage.setItem('token', token);\n    setToken(token);\n    setUserLevel(userData.userLevel);\n    setUsername(userData.username);\n    setIsAdmin(true);\n  };\n  \n  const handleLogout = () => {\n    localStorage.removeItem('token');\n    setToken('');\n    setUserLevel(2);\n    setUsername('');\n    setIsAdmin(false);\n  };\n  \n  if (isAdmin) {\n    return <AdminDashboard onLogout={handleLogout} userLevel={userLevel} username={username} />;\n  } else {\n    return <SurveyUserPanel onAdminLogin={handleLoginSuccess} />;\n  }\n};\n\n// User Panel Component - Fixed admin login handling\nconst SurveyUserPanel = ({ onAdminLogin }) => {\n  const [question, setQuestion] = useState(null);\n  const [department, setDepartment] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [submitted, setSubmitted] = useState(false);\n  const [submitting, setSubmitting] = useState(false);\n  const [departmentSlug, setDepartmentSlug] = useState('');\n  const [countdown, setCountdown] = useState(3);\n  const [selectedEmoji, setSelectedEmoji] = useState(null);\n  const [showAdminLogin, setShowAdminLogin] = useState(false);\n  const [loginForm, setLoginForm] = useState({ username: '', password: '' });\n  const [loginError, setLoginError] = useState('');\n  const [loginLoading, setLoginLoading] = useState(false);\n  const [clickCount, setClickCount] = useState(0);\n  const [showAdminButton, setShowAdminButton] = useState(false);\n  \n  const API_BASE_URL = getApiBaseUrl();\n  \n  // Function to read slug from text file\n  const readSlugFromFile = async () => {\n    try {\n      const response = await fetch(`${API_BASE_URL}/get-slug`);\n      if (response.ok) {\n        const data = await response.json();\n        return data.slug || '';\n      }\n      return '';\n    } catch (err) {\n      console.error('Failed to read slug file:', err);\n      return '';\n    }\n  };\n  \n  useEffect(() => {\n    const extractSlugFromUrl = async () => {\n      const pathname = window.location.pathname;\n      const urlParts = pathname.split('/').filter(part => part.length > 0);\n      let slug = '';\n      \n      if (urlParts.length === 0) {\n        slug = await readSlugFromFile();\n      } else if (urlParts.length === 1) {\n        slug = urlParts[0];\n      } else {\n        slug = urlParts[urlParts.length - 1];\n      }\n      \n      slug = slug.split('?')[0].split('#')[0];\n      return slug || await readSlugFromFile();\n    };\n    \n    const initializeSlug = async () => {\n      const slug = await extractSlugFromUrl();\n      setDepartmentSlug(slug);\n    };\n    \n    initializeSlug();\n  }, []);\n  \n  const emojiOptions = [\n    { id: 1, emoji: 'ðŸ˜', label: 'Excellent', color: 'bg-green-100 border-green-300 hover:bg-green-200' },\n    { id: 2, emoji: 'ðŸ˜Š', label: 'Good', color: 'bg-blue-100 border-blue-300 hover:bg-blue-200' },\n    { id: 3, emoji: 'ðŸ˜', label: 'Okay', color: 'bg-yellow-100 border-yellow-300 hover:bg-yellow-200' },\n    { id: 4, emoji: 'ðŸ˜ž', label: 'Poor', color: 'bg-orange-100 border-orange-300 hover:bg-orange-200' },\n    { id: 5, emoji: 'ðŸ˜¡', label: 'Terrible', color: 'bg-red-100 border-red-300 hover:bg-red-200' }\n  ];\n  \n  useEffect(() => {\n    let interval;\n    if (submitted && countdown > 0) {\n      interval = setInterval(() => {\n        setCountdown(prev => prev - 1);\n      }, 1000);\n    } else if (submitted && countdown === 0) {\n      window.location.reload();\n    }\n    \n    return () => {\n      if (interval) clearInterval(interval);\n    };\n  }, [submitted, countdown]);\n  \n  const handlePanelClick = () => {\n    const newCount = clickCount + 1;\n    setClickCount(newCount);\n    \n    if (newCount >= 5) {\n      setShowAdminButton(true);\n    }\n  };\n  \n  const loadActiveQuestion = async (slug) => {\n    if (!slug) return;\n    \n    try {\n      setLoading(true);\n      setError('');\n      \n      const response = await fetch(`${API_BASE_URL}/departments/${slug}/active-question`, {\n        method: 'GET',\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        }\n      });\n      \n      if (!response.ok) {\n        if (response.status === 404) {\n          throw new Error(`No active survey found for department: ${slug}`);\n        } else if (response.status === 500) {\n          throw new Error('Server error occurred. Please try again.');\n        } else if (!navigator.onLine) {\n          throw new Error('No internet connection. Please check your network.');\n        } else {\n          throw new Error(`Unable to load survey (Error: ${response.status})`);\n        }\n      }\n      \n      const data = await response.json();\n      setQuestion(data);\n      \n      const deptName = slug.replace(/-/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase());\n      setDepartment(deptName);\n      \n    } catch (err) {\n      console.error('Failed to load question:', err);\n      \n      if (err.name === 'TypeError' && err.message.includes('fetch')) {\n        setError('Cannot connect to survey server. Please check if the server is running and accessible.');\n      } else {\n        setError(err.message);\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n  \n  const submitAnswer = async (emojiOption) => {\n    if (!question || submitting) return;\n    \n    try {\n      setSubmitting(true);\n      setSelectedEmoji(emojiOption.id);\n      setError('');\n      \n      const response = await fetch(`${API_BASE_URL}/questions/${question.QuestionID}/answers`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        },\n        body: JSON.stringify({\n          emoji: emojiOption.emoji,\n          emojiId: emojiOption.id\n        })\n      });\n      \n      if (!response.ok) {\n        let errorMessage = 'Failed to submit answer';\n        \n        try {\n          const errorData = await response.json();\n          errorMessage = errorData.error || errorMessage;\n        } catch (parseError) {\n          if (response.status === 500) {\n            errorMessage = 'Server error occurred while submitting';\n          } else if (response.status === 404) {\n            errorMessage = 'Survey question not found';\n          } else {\n            errorMessage = `Submit failed (Error: ${response.status})`;\n          }\n        }\n        \n        throw new Error(errorMessage);\n      }\n      \n      const result = await response.json();\n      setSubmitted(true);\n      setCountdown(3);\n      \n    } catch (err) {\n      console.error('Failed to submit answer:', err);\n      \n      if (err.name === 'TypeError' && err.message.includes('fetch')) {\n        setError('Cannot connect to survey server to submit your response.');\n      } else {\n        setError(err.message);\n      }\n      setSelectedEmoji(null);\n    } finally {\n      setSubmitting(false);\n    }\n  };\n  \n  useEffect(() => {\n    if (departmentSlug) {\n      loadActiveQuestion(departmentSlug);\n    }\n  }, [departmentSlug]);\n  \n  const handleRetry = () => {\n    setError('');\n    setSelectedEmoji(null);\n    loadActiveQuestion(departmentSlug);\n  };\n  \n  // Fixed admin login handler\n  const handleAdminLogin = async (e) => {\n    e.preventDefault();\n    setLoginLoading(true);\n    setLoginError('');\n    \n    try {\n      const response = await fetch(`${API_BASE_URL}/admin/login`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(loginForm)\n      });\n      \n      if (response.ok) {\n        const data = await response.json();\n        // Call the parent's onAdminLogin with token and user data\n        onAdminLogin(data.token, data);\n      } else {\n        const errorData = await response.json();\n        throw new Error(errorData.error || 'Login failed');\n      }\n    } catch (err) {\n      setLoginError(err.message);\n    } finally {\n      setLoginLoading(false);\n    }\n  };\n  \n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 flex items-center justify-center\">\n      <div className=\"text-center\">\n      <div className=\"relative\">\n      <Loader2 className=\"w-16 h-16 text-white animate-spin mx-auto mb-4\" />\n      <div className=\"absolute inset-0 w-16 h-16 border-4 border-white border-opacity-20 rounded-full mx-auto animate-pulse\"></div>\n      </div>\n      <p className=\"text-white text-xl font-medium\">Loading survey...</p>\n      <p className=\"text-white text-sm opacity-75 mt-2\">Department: {departmentSlug}</p>\n      </div>\n      </div>\n    );\n  }\n  \n  if (error) {\n    return (\n      <div \n      className=\"min-h-screen bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 flex items-center justify-center cursor-pointer\"\n      onClick={handlePanelClick}\n      >\n      <div className=\"bg-white bg-opacity-95 backdrop-blur-sm rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4\">\n      <div className=\"text-center\">\n      <h2 className=\"text-3xl font-bold text-gray-800 mb-4\">Welcome!</h2>\n      \n      <div className=\"space-y-4 text-gray-600\">\n      <p className=\"text-lg\">Thank you for visiting our feedback system</p>\n      \n      <div className=\"bg-blue-50 border-2 border-blue-200 rounded-xl p-4\">\n      <p className=\"font-medium text-blue-800 mb-2\">\n      {department || departmentSlug.replace(/-/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase())} Department\n      </p>\n      </div>\n      \n      <div className=\"space-y-2 text-sm\">\n      <p>âœ¨ Your feedback matters to us</p>\n      <p>ðŸŽ¯ Help us improve our services</p>\n      <p>ðŸ’ Thank you for your patience</p>\n      </div>\n      </div>\n      \n      <div className=\"mt-6 space-y-4\">\n      <button\n      onClick={handleRetry}\n      className=\"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-all duration-200 flex items-center justify-center mx-auto gap-2\"\n      >\n      <RefreshCw className=\"w-4 h-4\" />\n      Check for Updates\n      </button>\n      \n      {showAdminButton && (\n        <button\n        onClick={() => setShowAdminLogin(!showAdminLogin)}\n        className=\"fixed top-4 right-4 z-50 overflow-hidden bg-blue-600 text-white px-4 py-2 rounded-full hover:bg-blue-700 transition-all duration-200 flex items-center gap-2 shadow-lg animate-pulse\"                >\n        <span className=\"relative z-10 flex items-center gap-1\"></span>\n        <Lock className=\"w-4 h-4\" />\n        <span className=\"text-sm\">Admin</span>\n        </button>\n      )}\n      </div>\n      \n      {showAdminLogin && (\n        <div className=\"mt-6 pt-4 border-t border-gray-200\">\n        <h3 className=\"text-lg font-medium text-gray-800 mb-3\">Admin Login</h3>\n        {loginError && (\n          <div className=\"mb-3 p-2 bg-red-100 text-red-700 rounded-md text-sm\">\n          {loginError}\n          </div>\n        )}\n        <form onSubmit={handleAdminLogin}>\n        <div className=\"mb-3\">\n        <input\n        type=\"text\"\n        placeholder=\"Username\"\n        value={loginForm.username}\n        onChange={(e) => setLoginForm({...loginForm, username: e.target.value})}\n        className=\"w-full p-2 border rounded-md text-sm\"\n        required\n        />\n        </div>\n        <div className=\"mb-3\">\n        <input\n        type=\"password\"\n        placeholder=\"Password\"\n        value={loginForm.password}\n        onChange={(e) => setLoginForm({...loginForm, password: e.target.value})}\n        className=\"w-full p-2 border rounded-md text-sm\"\n        required\n        />\n        </div>\n        <button\n        type=\"submit\"\n        disabled={loginLoading}\n        className=\"w-full py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 disabled:bg-gray-400 text-sm\"\n        >\n        {loginLoading ? 'Logging in...' : 'Login'}\n        </button>\n        </form>\n        </div>\n      )}\n      </div>\n      </div>\n      </div>\n    );\n  }\n  \n  // Success state with countdown\n  if (submitted) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-green-900 via-green-800 to-green-900 flex items-center justify-center\">\n      <div className=\"bg-white bg-opacity-95 backdrop-blur-sm rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4\">\n      <div className=\"text-center\">\n      <CheckCircle className=\"w-20 h-20 text-green-500 mx-auto mb-4\" />\n      <h2 className=\"text-3xl font-bold text-gray-800 mb-2\">Thank You!</h2>\n      <p className=\"text-gray-600 mb-2\">Your feedback has been submitted successfully.</p>\n      <p className=\"text-sm text-gray-500 mb-6\">Department: {department}</p>\n      \n      <div className=\"bg-green-50 border-2 border-green-200 rounded-xl p-4 mb-4\">\n      <p className=\"text-green-700 font-medium mb-2\">Waiting for next employee</p>\n      <div className=\"flex items-center justify-center\">\n      <div className=\"relative\">\n      <Loader2 className=\"w-6 h-6 text-green-600 animate-spin mr-2\" />\n      </div>\n      <span className=\"text-green-600 font-semibold text-lg\">\n      Refreshing in {countdown}...\n      </span>\n      </div>\n      </div>\n      \n      <p className=\"text-xs text-gray-400\">\n      The page will automatically refresh for the next person\n      </p>\n      </div>\n      </div>\n      </div>\n    );\n  }\n  \n  return (\n    <div \n    className=\"min-h-screen bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 relative overflow-hidden\"\n    onClick={handlePanelClick}\n    >\n    {showAdminButton && (\n      <button\n      onClick={() => setShowAdminLogin(!showAdminLogin)}\n      className=\"fixed top-4 right-4 z-50 overflow-hidden bg-blue-600 text-white px-4 py-2 rounded-full hover:bg-blue-700 transition-all duration-200 flex items-center gap-2 shadow-lg animate-pulse\"                >\n      <span className=\"relative z-10 flex items-center gap-1\"></span>\n      <Lock className=\"w-4 h-4\" />\n      <span className=\"text-sm\">Admin</span>\n      </button>\n    )}\n    \n    {showAdminLogin && (\n      <div className=\"fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center p-4\">\n      <div className=\"bg-white rounded-lg shadow-xl p-6 max-w-md w-full\">\n      <div className=\"flex justify-between items-center mb-4\">\n      <h3 className=\"text-xl font-bold text-gray-800\">Admin Login</h3>\n      <button \n      onClick={() => setShowAdminLogin(false)}\n      className=\"text-gray-500 hover:text-gray-700\"\n      >\n      Ã—\n      </button>\n      </div>\n      \n      {loginError && (\n        <div className=\"mb-4 p-3 bg-red-100 text-red-700 rounded-md text-sm\">\n        {loginError}\n        </div>\n      )}\n      \n      <form onSubmit={handleAdminLogin}>\n      <div className=\"mb-4\">\n      <label className=\"block text-gray-700 text-sm font-medium mb-1\">Username</label>\n      <input\n      type=\"text\"\n      value={loginForm.username}\n      onChange={(e) => setLoginForm({...loginForm, username: e.target.value})}\n      className=\"w-full p-2 border rounded-md\"\n      required\n      />\n      </div>\n      \n      <div className=\"mb-6\">\n      <label className=\"block text-gray-700 text-sm font-medium mb-1\">Password</label>\n      <input\n      type=\"password\"\n      value={loginForm.password}\n      onChange={(e) => setLoginForm({...loginForm, password: e.target.value})}\n      className=\"w-full p-2 border rounded-md\"\n      required\n      />\n      </div>\n      \n      <button\n      type=\"submit\"\n      disabled={loginLoading}\n      className=\"w-full py-2 px-4 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400\"\n      >\n      {loginLoading ? 'Logging in...' : 'Login'}\n      </button>\n      </form>\n      </div>\n      </div>\n    )}\n    \n    <div className=\"absolute inset-0 overflow-hidden\">\n    <div className=\"absolute -top-1/2 -left-1/2 w-full h-full bg-gradient-to-br from-blue-500 to-purple-600 opacity-20 rounded-full animate-pulse\"></div>\n    <div className=\"absolute -bottom-1/2 -right-1/2 w-full h-full bg-gradient-to-tl from-purple-500 to-indigo-600 opacity-20 rounded-full animate-pulse\" style={{ animationDelay: '3s' }}></div>\n    </div>\n    \n    <div className=\"relative z-10 max-w-4xl mx-auto px-4 py-8\">\n    <div className=\"max-w-2xl mx-auto\">\n    <div className=\"text-center mb-8\">\n    <h1 className=\"text-5xl font-bold text-white mb-2 drop-shadow-lg\">\n    Happiness Survey\n    </h1>\n    <p className=\"text-white text-2xl drop-shadow-md opacity-90\">{department} Department</p>\n    <div className=\"w-20 h-1 bg-white bg-opacity-50 mx-auto mt-4 rounded-full\"></div>\n    </div>\n    \n    <div className=\"bg-white bg-opacity-95 backdrop-blur-sm rounded-2xl shadow-2xl p-8 border border-white border-opacity-50 relative overflow-hidden\">\n    <div className=\"mb-8\">\n    <h2 className=\"text-2xl font-semibold text-gray-800 mb-4 text-center leading-relaxed\">\n    {question?.QuestionText}\n    </h2>\n    <p className=\"text-gray-600 text-center\">\n    Please select your response:\n    </p>\n    </div>\n    \n    <div className=\"grid grid-cols-1 sm:grid-cols-5 gap-4 mb-6\">\n    {emojiOptions.map((option) => (\n      <button\n      key={option.id}\n      onClick={() => submitAnswer(option)}\n      disabled={submitting}\n      className={`\n                    flex flex-col items-center p-6 rounded-xl border-2 transition-all duration-300 \n                    transform hover:scale-105 hover:shadow-lg active:scale-95\n                    ${submitting && selectedEmoji === option.id ? 'scale-95 opacity-75' : ''}\n                    ${option.color}\n                    disabled:cursor-not-allowed\n                    focus:outline-none focus:ring-4 focus:ring-blue-300\n                  `}\n        >\n        <span className=\"text-5xl mb-3 select-none\">\n        {option.emoji}\n        </span>\n        <span className=\"text-sm text-gray-700 font-medium\">\n        {option.label}\n        </span>\n        {submitting && selectedEmoji === option.id && (\n          <Loader2 className=\"w-4 h-4 text-gray-600 animate-spin mt-2\" />\n        )}\n        </button>\n      ))}\n      </div>\n      \n      {submitting && (\n        <div className=\"text-center py-4\">\n        <div className=\"flex items-center justify-center mb-2\">\n        <Loader2 className=\"w-6 h-6 text-blue-600 animate-spin mr-2\" />\n        <span className=\"text-gray-700 font-medium\">Submitting your response...</span>\n        </div>\n        <div className=\"w-32 h-2 bg-gray-200 rounded-full mx-auto overflow-hidden\">\n        <div className=\"h-full bg-blue-600 rounded-full animate-pulse\"></div>\n        </div>\n        </div>\n      )}\n      \n      <div className=\"text-center text-sm text-gray-500 mt-6\">\n      <p className=\"mb-1\">Click on any emoji to submit your feedback</p>\n      <p className=\"text-xs\">Your response is anonymous and helps us improve our services</p>\n      </div>\n      </div>\n      \n      <div className=\"text-center mt-8\">\n      <p className=\"text-white text-sm drop-shadow-md opacity-75\">\n      Thank you for taking the time to share your feedback\n      </p>\n      </div>\n      </div>\n      </div>\n      </div>\n    );\n  };\n  // Admin Dashboard Component\n  const AdminDashboard = ({ onLogout, userLevel, username }) => {\n    const [activeTab, setActiveTab] = useState(userLevel === 1 ? 'departments' : 'questions');\n    const [departments, setDepartments] = useState([]);\n    const [questions, setQuestions] = useState([]);\n    const [newDepartment, setNewDepartment] = useState('');\n    const [newQuestion, setNewQuestion] = useState('');\n    const [selectedDepartment, setSelectedDepartment] = useState('');\n    const [reports, setReports] = useState([]);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState('');\n    const [historyData, setHistoryData] = useState([]);\n    const [filteredData, setFilteredData] = useState([]);\n    const [selectedDepartmentForHistory, setSelectedDepartmentForHistory] = useState('');\n    const [startDate, setStartDate] = useState('');\n    const [endDate, setEndDate] = useState('');\n    const [exportLoading, setExportLoading] = useState(false);\n    const [success, setSuccess] = useState('');\n    const [registerForm, setRegisterForm] = useState({\n      username: '',\n      password: '',\n      confirmPassword: '',\n      userLevel: 2\n    });\n    \n    const getApiBaseUrl = () => {\n      const hostname = window.location.hostname;\n      if (hostname === 'localhost' || hostname === '127.0.0.1') {\n        return 'http://localhost:5000/api';\n      }\n      return `http://${hostname}:5000/api`;\n    };\n    \n    const API_BASE_URL = getApiBaseUrl();\n    \n    const loadDepartments = async () => {\n      try {\n        setLoading(true);\n        const response = await fetch(`${API_BASE_URL}/departments`);\n        \n        if (!response.ok) {\n          throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        \n        const data = await response.json();\n        setDepartments(Array.isArray(data) ? data : []);\n        setError('');\n      } catch (err) {\n        console.error('Failed to load departments:', err);\n        setDepartments([]);\n        setError('Failed to load departments: ' + err.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    const loadQuestions = async () => {\n      try {\n        setLoading(true);\n        const response = await fetch(`${API_BASE_URL}/questions`);\n        \n        if (!response.ok) {\n          throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        \n        const data = await response.json();\n        setQuestions(Array.isArray(data) ? data : []);\n        setError('');\n      } catch (err) {\n        console.error('Failed to load questions:', err);\n        setQuestions([]);\n        setError('Failed to load questions: ' + err.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    const loadHistoryData = async (departmentId = '', startDate = '', endDate = '') => {\n      try {\n        setLoading(true);\n        let url = `${API_BASE_URL}/reports/history`;\n        const params = new URLSearchParams();\n        \n        if (departmentId) params.append('departmentId', departmentId);\n        if (startDate) params.append('startDate', startDate);\n        if (endDate) params.append('endDate', endDate);\n        \n        if (params.toString()) {\n          url += `?${params.toString()}`;\n        }\n        \n        const response = await fetch(url);\n        \n        if (!response.ok) {\n          throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        \n        const data = await response.json();\n        setHistoryData(Array.isArray(data) ? data : []);\n        setFilteredData(Array.isArray(data) ? data : []);\n        setError('');\n      } catch (err) {\n        console.error('Failed to load history data:', err);\n        setHistoryData([]);\n        setFilteredData([]);\n        setError('Failed to load history data: ' + err.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    const updateDepartment = async (id, newName) => {\n      try {\n        setLoading(true);\n        setError('');\n        setSuccess('');\n        \n        const response = await fetch(`${API_BASE_URL}/departments/${id}`, {\n          method: 'PUT',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ name: newName.trim() })\n        });\n        \n        if (response.ok) {\n          setSuccess('Department updated successfully!');\n          setTimeout(() => setSuccess(''), 3000);\n          await loadDepartments();\n        } else {\n          const errorData = await response.json();\n          throw new Error(errorData.error || 'Failed to update department');\n        }\n      } catch (err) {\n        setError(err.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    const deleteDepartment = async (id) => {\n      if (!window.confirm('Are you sure you want to delete this department? This cannot be undone.')) {\n        return;\n      }\n      \n      try {\n        setLoading(true);\n        setError('');\n        setSuccess('');\n        \n        const response = await fetch(`${API_BASE_URL}/departments/${id}`, {\n          method: 'DELETE'\n        });\n        \n        if (response.ok) {\n          setSuccess('Department deleted successfully!');\n          setTimeout(() => setSuccess(''), 3000);\n          await loadDepartments();\n        } else {\n          const errorData = await response.json();\n          throw new Error(errorData.error || 'Failed to delete department');\n        }\n      } catch (err) {\n        setError(err.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    const exportToExcel = async () => {\n      try {\n        setExportLoading(true);\n        \n        let url = `${API_BASE_URL}/reports/export`;\n        const params = new URLSearchParams();\n        \n        if (selectedDepartmentForHistory) params.append('departmentId', selectedDepartmentForHistory);\n        if (startDate) params.append('startDate', startDate);\n        if (endDate) params.append('endDate', endDate);\n        \n        if (params.toString()) {\n          url += `?${params.toString()}`;\n        }\n        \n        const response = await fetch(url);\n        \n        if (!response.ok) {\n          throw new Error(`Export failed: ${response.status}`);\n        }\n        \n        const blob = await response.blob();\n        const downloadUrl = window.URL.createObjectURL(blob);\n        const link = document.createElement('a');\n        link.href = downloadUrl;\n        \n        const now = new Date();\n        const dateStr = now.toISOString().split('T')[0];\n        const deptName = selectedDepartmentForHistory ?\n        departments.find(d => d.DepartmentID == selectedDepartmentForHistory)?.Name || 'Selected' : 'All';\n        \n        link.download = `Survey_Report_${deptName}_${dateStr}.xlsx`;\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n        \n        window.URL.revokeObjectURL(downloadUrl);\n        \n      } catch (err) {\n        console.error('Export failed:', err);\n        setError('Export failed: ' + err.message);\n      } finally {\n        setExportLoading(false);\n      }\n    };\n    \n    const handleFilterChange = () => {\n      loadHistoryData(selectedDepartmentForHistory, startDate, endDate);\n    };\n    \n    const loadReports = async () => {\n      try {\n        setLoading(true);\n        const response = await fetch(`${API_BASE_URL}/reports`);\n        \n        if (!response.ok) {\n          throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        \n        const data = await response.json();\n        \n        const processedReports = data.map(report => {\n          const emojiCounts = {\n            1: 0, // Excellent\n            2: 0, // Good\n            3: 0, // Okay\n            4: 0, // Poor\n            5: 0  // Terrible\n          };\n          \n          if (report.responses && Array.isArray(report.responses)) {\n            report.responses.forEach(response => {\n              const emojiId = response.EmojiID;\n              if (emojiCounts.hasOwnProperty(emojiId)) {\n                emojiCounts[emojiId] = response.Count || 0;\n              }\n            });\n          }\n          \n          const emojiData = [\n            { emoji: 'ðŸ˜', label: 'Excellent', count: emojiCounts[1], id: 1 },\n            { emoji: 'ðŸ˜Š', label: 'Good', count: emojiCounts[2], id: 2 },\n            { emoji: 'ðŸ˜', label: 'Okay', count: emojiCounts[3], id: 3 },\n            { emoji: 'ðŸ˜ž', label: 'Poor', count: emojiCounts[4], id: 4 },\n            { emoji: 'ðŸ˜¡', label: 'Terrible', count: emojiCounts[5], id: 5 }\n          ];\n          \n          return {\n            department: report.department,\n            question: report.question,\n            totalResponses: report.totalResponses || 0,\n            responses: report.responses || [],\n            emojiData: emojiData\n          };\n        });\n        \n        setReports(processedReports);\n        setError('');\n      } catch (err) {\n        console.error('Failed to load reports:', err);\n        setReports([]);\n        setError('Failed to load reports: ' + err.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    const addDepartment = async () => {\n      if (!newDepartment.trim()) {\n        setError('Department name is required');\n        return;\n      }\n      \n      setLoading(true);\n      setError('');\n      setSuccess('');\n      \n      try {\n        const response = await fetch(`${API_BASE_URL}/departments`, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ name: newDepartment.trim() })\n        });\n        \n        if (response.ok) {\n          setNewDepartment('');\n          setSuccess('Department added successfully!');\n          setTimeout(() => setSuccess(''), 3000);\n          await loadDepartments();\n        } else {\n          const errorData = await response.json();\n          throw new Error(errorData.error || 'Failed to add department');\n        }\n      } catch (err) {\n        setError(err.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    const addQuestion = async () => {\n      if (!selectedDepartment || !newQuestion.trim()) {\n        setError('Department and question text are required');\n        return;\n      }\n      \n      setLoading(true);\n      setError('');\n      setSuccess('');\n      \n      try {\n        const dept = departments.find(d => d.DepartmentID == selectedDepartment);\n        if (!dept) {\n          throw new Error('Department not found');\n        }\n        \n        const response = await fetch(`${API_BASE_URL}/departments/${dept.URLSlug}/questions`, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ questionText: newQuestion.trim() })\n        });\n        \n        if (response.ok) {\n          setNewQuestion('');\n          setSelectedDepartment('');\n          setSuccess('Question added successfully!');\n          setTimeout(() => setSuccess(''), 3000);\n          await loadQuestions();\n        } else {\n          const errorData = await response.json();\n          throw new Error(errorData.error || 'Failed to add question');\n        }\n      } catch (err) {\n        setError(err.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    const handleRegister = async (e) => {\n      e.preventDefault();\n      setLoading(true);\n      setError('');\n      setSuccess('');\n      \n      if (registerForm.password !== registerForm.confirmPassword) {\n        setError('Passwords do not match');\n        setLoading(false);\n        return;\n      }\n      \n      try {\n        const token = localStorage.getItem('token');\n        const response = await fetch(`${API_BASE_URL}/admin/register`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${token}`\n          },\n          body: JSON.stringify({\n            username: registerForm.username,\n            password: registerForm.password,\n            userLevel: registerForm.userLevel\n          })\n        });\n        \n        if (response.ok) {\n          setRegisterForm({ username: '', password: '', confirmPassword: '', userLevel: 2 });\n          setError('');\n          setSuccess('Admin registered successfully!');\n          setTimeout(() => setSuccess(''), 3000);\n        } else {\n          const errorData = await response.json();\n          throw new Error(errorData.error || 'Registration failed');\n        }\n      } catch (err) {\n        setError(err.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    useEffect(() => {\n      loadDepartments();\n    }, []);\n    \n    useEffect(() => {\n      if (activeTab === 'questions') {\n        loadQuestions();\n      } else if (activeTab === 'reports') {\n        loadReports();\n      } else if (activeTab === 'history') {\n        loadHistoryData();\n      }\n    }, [activeTab]);\n    \n    return (\n      <div className=\"min-h-screen bg-gray-100\">\n      <div className=\"bg-white shadow-sm border-b\">\n      <div className=\"max-w-7xl mx-auto px-4 py-6 flex justify-between items-center\">\n      <h1 className=\"text-3xl font-bold text-gray-900\">Survey Admin Dashboard</h1>\n      <div className=\"flex items-center space-x-4\">\n      <span className=\"text-gray-700\">Logged in as: {username}</span>\n      <button\n      onClick={onLogout}\n      className=\"flex items-center gap-1 px-3 py-1 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300\"\n      >\n      <LogOut className=\"w-4 h-4\" />\n      Logout\n      </button>\n      </div>\n      </div>\n      </div>\n      \n      <div className=\"max-w-7xl mx-auto px-4 py-8\">\n      <div className=\"flex space-x-4 mb-8\">\n      {userLevel === 1 && (\n        <button\n        onClick={() => setActiveTab('departments')}\n        className={`px-4 py-2 rounded-md font-medium ${activeTab === 'departments'\n          ? 'bg-blue-100 text-blue-700'\n          : 'text-gray-600 hover:bg-gray-100'\n        }`}\n        >\n        Departments\n        </button>\n      )}\n      \n      <button\n      onClick={() => setActiveTab('questions')}\n      className={`px-4 py-2 rounded-md font-medium ${activeTab === 'questions'\n        ? 'bg-blue-100 text-blue-700'\n        : 'text-gray-600 hover:bg-gray-100'\n      }`}\n      >\n      Send Questions\n      </button>\n      \n      <button\n      onClick={() => setActiveTab('reports')}\n      className={`px-4 py-2 rounded-md font-medium ${activeTab === 'reports'\n        ? 'bg-blue-100 text-blue-700'\n        : 'text-gray-600 hover:bg-gray-100'\n      }`}\n      >\n      Reports\n      </button>\n      \n      <button\n      onClick={() => setActiveTab('history')}\n      className={`px-4 py-2 rounded-md font-medium ${activeTab === 'history'\n        ? 'bg-blue-100 text-blue-700'\n        : 'text-gray-600 hover:bg-gray-100'\n      }`}\n      >\n      History\n      </button>\n      \n      {userLevel === 1 && (\n        <button\n        onClick={() => setActiveTab('admin-register')}\n        className={`px-4 py-2 rounded-md font-medium ${activeTab === 'admin-register'\n          ? 'bg-blue-100 text-blue-700'\n          : 'text-gray-600 hover:bg-gray-100'\n        }`}\n        >\n        Admin Register\n        </button>\n      )}\n      </div>\n      \n      {activeTab === 'departments' && userLevel === 1 && (\n        <div className=\"bg-white rounded-lg shadow-md p-6\">\n        <h2 className=\"text-xl font-bold mb-4\">Departments</h2>\n        {error && (\n          <div className=\"mb-4 p-3 bg-red-100 text-red-700 rounded-md\">\n          {error}\n          </div>\n        )}\n        {success && (\n          <div className=\"mb-4 p-3 bg-green-100 text-green-700 rounded-md\">\n          {success}\n          </div>\n        )}\n        <div className=\"mb-6\">\n        <input\n        type=\"text\"\n        value={newDepartment}\n        onChange={(e) => setNewDepartment(e.target.value)}\n        placeholder=\"New department name\"\n        className=\"w-full p-2 border rounded-md\"\n        onKeyPress={(e) => e.key === 'Enter' && addDepartment()}\n        />\n        <button\n        onClick={addDepartment}\n        disabled={loading}\n        className=\"mt-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400\"\n        >\n        {loading ? 'Adding...' : 'Add Department'}\n        </button>\n        </div>\n        <div className=\"space-y-2\">\n        {departments.length === 0 ? (\n          <p className=\"text-gray-500 text-center py-4\">No departments found</p>\n        ) : (\n          departments.map(dept => (\n            <div key={dept.DepartmentID} className=\"p-3 border rounded-md flex justify-between items-center\">\n            <div>\n            <p className=\"font-medium\">{dept.Name}</p>\n            <p className=\"text-sm text-gray-600\">URL: /survey/{dept.URLSlug}</p>\n            </div>\n            <div className=\"flex space-x-2\">\n            <button\n            onClick={() => {\n              const newName = prompt('Enter new department name:', dept.Name);\n              if (newName && newName.trim() && newName !== dept.Name) {\n                updateDepartment(dept.DepartmentID, newName);\n              }\n            }}\n            className=\"px-2 py-1 text-sm bg-yellow-100 text-yellow-800 rounded hover:bg-yellow-200\"\n            >\n            Edit\n            </button>\n            <button\n            onClick={() => deleteDepartment(dept.DepartmentID)}\n            className=\"px-2 py-1 text-sm bg-red-100 text-red-800 rounded hover:bg-red-200\"\n            >\n            Delete\n            </button>\n            </div>\n            </div>\n          ))\n        )}\n        </div>\n        </div>\n      )}\n      \n      {activeTab === 'questions' && (\n        <div className=\"bg-white rounded-lg shadow-md p-6\">\n        <h2 className=\"text-xl font-bold mb-4\">Create Question</h2>\n        {error && (\n          <div className=\"mb-4 p-3 bg-red-100 text-red-700 rounded-md\">\n          {error}\n          </div>\n        )}\n        {success && (\n          <div className=\"mb-4 p-3 bg-green-100 text-green-700 rounded-md\">\n          {success}\n          </div>\n        )}\n        \n        <div className=\"mb-6\">\n        <select\n        value={selectedDepartment}\n        onChange={(e) => setSelectedDepartment(e.target.value)}\n        className=\"w-full p-2 border rounded-md mb-2\"\n        >\n        <option value=\"\">Select department</option>\n        {departments.map(dept => (\n          <option key={dept.DepartmentID} value={dept.DepartmentID}>\n          {dept.Name}\n          </option>\n        ))}\n        </select>\n        <textarea\n        value={newQuestion}\n        onChange={(e) => setNewQuestion(e.target.value)}\n        placeholder=\"Question text\"\n        rows={3}\n        className=\"w-full p-2 border rounded-md\"\n        />\n        <button\n        onClick={addQuestion}\n        disabled={loading}\n        className=\"mt-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400\"\n        >\n        {loading ? 'Adding...' : 'Add Question'}\n        </button>\n        </div>\n        <h3 className=\"text-lg font-bold mb-2\">Current Questions</h3>\n        <div className=\"space-y-3\">\n        {questions.length === 0 ? (\n          <p className=\"text-gray-500 text-center py-4\">No questions found</p>\n        ) : (\n          questions.map(q => {\n            const dept = departments.find(d => d.DepartmentID === q.DepartmentID);\n            return (\n              <div key={q.QuestionID} className=\"p-3 border rounded-md\">\n              <div className=\"flex justify-between items-start\">\n              <p className=\"flex-1\">{q.QuestionText}</p>\n              <span className={`px-2 py-1 text-xs rounded ml-2 ${q.IsActive ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'}`}>\n              {q.IsActive ? 'Active' : 'Inactive'}\n              </span>\n              </div>\n              <p className=\"text-sm text-gray-600 mt-1\">\n              {dept?.Name || 'Unknown Department'} â€¢ {q.CreatedAt ? new Date(q.CreatedAt).toLocaleString() : 'Date not available'}\n              </p>\n              </div>\n            );\n          })\n        )}\n        </div>\n        </div>\n      )}\n      \n      {activeTab === 'reports' && (\n        <div className=\"bg-white rounded-lg shadow-md p-6\">\n        <div className=\"flex justify-between items-center mb-6\">\n        <h2 className=\"text-xl font-bold\">Ongoing Surveys</h2>\n        <button\n        onClick={loadReports}\n        disabled={loading}\n        className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400\"\n        >\n        {loading ? 'Refreshing...' : 'Refresh Data'}\n        </button>\n        </div>\n        \n        <div className=\"space-y-6\">\n        {reports.length === 0 ? (\n          <div className=\"text-center py-8\">\n          <p className=\"text-gray-500 mb-4\">No reports available</p>\n          <p className=\"text-sm text-gray-400\">Make sure you have departments with active questions and responses</p>\n          </div>\n        ) : (\n          reports.map((report, i) => (\n            <div key={i} className=\"border rounded-lg p-6 bg-gray-50\">\n            <div className=\"mb-4\">\n            <h3 className=\"font-bold text-lg text-gray-900\">{report.department}</h3>\n            <p className=\"text-gray-700 mt-2 text-base\">{report.question}</p>\n            <p className=\"text-sm text-gray-600 mt-1\">\n            Total responses: <span className=\"font-semibold\">{report.totalResponses}</span>\n            </p>\n            </div>\n            \n            <div className=\"bg-white rounded-lg p-4 border\">\n            <h4 className=\"font-medium mb-4 text-gray-700\">Response Breakdown:</h4>\n            \n            {report.totalResponses > 0 ? (\n              <div className=\"grid grid-cols-5 gap-4\">\n              {report.emojiData.map((item, j) => {\n                const percentage = report.totalResponses > 0 ? ((item.count / report.totalResponses) * 100).toFixed(1) : 0;\n                return (\n                  <div key={j} className=\"text-center\">\n                  <div className=\"text-4xl mb-2\">{item.emoji}</div>\n                  <div className=\"font-bold text-2xl text-gray-800\">{item.count}</div>\n                  <div className=\"text-sm text-gray-600 font-medium\">{percentage}%</div>\n                  <div className=\"text-xs text-gray-500 mt-1\">{item.label}</div>\n                  </div>\n                );\n              })}\n              </div>\n            ) : (\n              <div className=\"text-center py-6 text-gray-500\">\n              No responses yet for this question\n              </div>\n            )}\n            </div>\n            </div>\n          ))\n        )}\n        </div>\n        </div>\n      )}\n      \n      {activeTab === 'history' && (\n        <div className=\"bg-white rounded-lg shadow-md p-6\">\n        <div className=\"flex justify-between items-center mb-6\">\n        <h2 className=\"text-xl font-bold\">Survey History & Export</h2>\n        <button\n        onClick={exportToExcel}\n        disabled={exportLoading || filteredData.length === 0}\n        className=\"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-400\"\n        >\n        <Download className=\"w-4 h-4\" />\n        {exportLoading ? 'Exporting...' : 'Export to Excel'}\n        </button>\n        </div>\n        \n        <div className=\"bg-gray-50 p-4 rounded-lg mb-6\">\n        <h3 className=\"font-medium mb-4 flex items-center gap-2\">\n        <Building className=\"w-4 h-4\" />\n        Filter Options\n        </h3>\n        \n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n        <div>\n        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n        Department\n        </label>\n        <select\n        value={selectedDepartmentForHistory}\n        onChange={(e) => setSelectedDepartmentForHistory(e.target.value)}\n        className=\"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500\"\n        >\n        <option value=\"\">All Departments</option>\n        {departments.map(dept => (\n          <option key={dept.DepartmentID} value={dept.DepartmentID}>\n          {dept.Name}\n          </option>\n        ))}\n        </select>\n        </div>\n        \n        <div>\n        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n        Start Date\n        </label>\n        <input\n        type=\"date\"\n        value={startDate}\n        onChange={(e) => setStartDate(e.target.value)}\n        className=\"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500\"\n        />\n        </div>\n        \n        <div>\n        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n        End Date\n        </label>\n        <input\n        type=\"date\"\n        value={endDate}\n        onChange={(e) => setEndDate(e.target.value)}\n        className=\"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500\"\n        />\n        </div>\n        </div>\n        \n        <div className=\"flex gap-2 mt-4\">\n        <button\n        onClick={handleFilterChange}\n        disabled={loading}\n        className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400\"\n        >\n        {loading ? 'Filtering...' : 'Apply Filters'}\n        </button>\n        <button\n        onClick={() => {\n          setSelectedDepartmentForHistory('');\n          setStartDate('');\n          setEndDate('');\n          loadHistoryData();\n        }}\n        className=\"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600\"\n        >\n        Clear Filters\n        </button>\n        </div>\n        </div>\n        {filteredData.length > 0 && (\n          <div className=\"bg-blue-50 p-4 rounded-lg mb-6\">\n          <div className=\"flex items-center gap-2 mb-2\">\n          <BarChart3 className=\"w-4 h-4 text-blue-600\" />\n          <span className=\"font-medium text-blue-800\">Results Summary</span>\n          </div>\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm\">\n          <div>\n          <span className=\"text-gray-600\">Total Records: </span>\n          <span className=\"font-semibold\">{filteredData.length}</span>\n          </div>\n          <div>\n          <span className=\"text-gray-600\">Total Responses: </span>\n          <span className=\"font-semibold\">\n          {filteredData.reduce((sum, item) => sum + (item.totalResponses || 0), 0)}\n          </span>\n          </div>\n          <div>\n          <span className=\"text-gray-600\">Departments: </span>\n          <span className=\"font-semibold\">\n          {new Set(filteredData.map(item => item.department)).size}\n          </span>\n          </div>\n          </div>\n          </div>\n        )}\n        \n        <div className=\"space-y-4\">\n        {loading ? (\n          <div className=\"text-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto\"></div>\n          <p className=\"mt-2 text-gray-600\">Loading history data...</p>\n          </div>\n        ) : filteredData.length === 0 ? (\n          <div className=\"text-center py-8\">\n          <History className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n          <p className=\"text-gray-500 mb-2\">No survey data found</p>\n          <p className=\"text-sm text-gray-400\">\n          Try adjusting your filters or create some surveys to see data here\n          </p>\n          </div>\n        ) : (\n          filteredData.map((item, index) => (\n            <div key={index} className=\"border rounded-lg p-4 bg-gray-50\">\n            <div className=\"flex justify-between items-start mb-3\">\n            <div>\n            <h3 className=\"font-bold text-lg text-gray-900\">{item.department}</h3>\n            <p className=\"text-gray-700 mt-1\">{item.question}</p>\n            </div>\n            <div className=\"text-right\">\n            <p className=\"text-sm text-gray-600\">\n            Total Responses: <span className=\"font-semibold\">{item.totalResponses}</span>\n            </p>\n            {item.createdAt && (\n              <p className=\"text-xs text-gray-500 mt-1\">\n              {new Date(item.createdAt).toLocaleDateString()}\n              </p>\n            )}\n            </div>\n            </div>\n            \n            {item.emojiData && item.totalResponses > 0 && (\n              <div className=\"bg-white rounded-lg p-3 border\">\n              <div className=\"grid grid-cols-5 gap-2\">\n              {item.emojiData.map((emoji, i) => (\n                <div key={i} className=\"text-center\">\n                <div className=\"text-2xl mb-1\">{emoji.emoji}</div>\n                <div className=\"font-bold text-lg\">{emoji.count}</div>\n                <div className=\"text-xs text-gray-600\">\n                {item.totalResponses > 0 ?\n                  ((emoji.count / item.totalResponses) * 100).toFixed(1) : 0}%\n                  </div>\n                  </div>\n                ))}\n                </div>\n                </div>\n              )}\n              </div>\n            ))\n          )}\n          </div>\n          </div>\n        )}\n        \n        {activeTab === 'admin-register' && (\n          <div className=\"bg-white rounded-lg shadow-md p-6\">\n          <h2 className=\"text-xl font-bold mb-4\">Register New Admin</h2>\n          {error && (\n            <div className=\"mb-4 p-3 bg-red-100 text-red-700 rounded-md\">\n            {error}\n            </div>\n          )}\n          {success && (\n            <div className=\"mb-4 p-3 bg-green-100 text-green-700 rounded-md\">\n            {success}\n            </div>\n          )}\n          \n          <form onSubmit={handleRegister}>\n          <div className=\"mb-4\">\n          <label className=\"block text-gray-700 text-sm font-medium mb-2\">\n          Username\n          </label>\n          <input\n          type=\"text\"\n          value={registerForm.username}\n          onChange={(e) => setRegisterForm({ ...registerForm, username: e.target.value })}\n          className=\"w-full p-2 border rounded-md\"\n          required\n          />\n          </div>\n          \n          <div className=\"mb-4\">\n          <label className=\"block text-gray-700 text-sm font-medium mb-2\">\n          Password\n          </label>\n          <input\n          type=\"password\"\n          value={registerForm.password}\n          onChange={(e) => setRegisterForm({ ...registerForm, password: e.target.value })}\n          className=\"w-full p-2 border rounded-md\"\n          required\n          />\n          </div>\n          \n          <div className=\"mb-4\">\n          <label className=\"block text-gray-700 text-sm font-medium mb-2\">\n          Confirm Password\n          </label>\n          <input\n          type=\"password\"\n          value={registerForm.confirmPassword}\n          onChange={(e) => setRegisterForm({ ...registerForm, confirmPassword: e.target.value })}\n          className=\"w-full p-2 border rounded-md\"\n          required\n          />\n          </div>\n          \n          <div className=\"mb-4\">\n          <label className=\"block text-gray-700 text-sm font-medium mb-2\">\n          Admin Level\n          </label>\n          <select\n          value={registerForm.userLevel}\n          onChange={(e) => setRegisterForm({ ...registerForm, userLevel: parseInt(e.target.value) })}\n          className=\"w-full p-2 border rounded-md\"\n          >\n          <option value={1}>Super Admin</option>\n          <option value={2}>Admin</option>\n          </select>\n          </div>\n          \n          <button\n          type=\"submit\"\n          disabled={loading}\n          className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400\"\n          >\n          {loading ? 'Registering...' : 'Register Admin'}\n          </button>\n          </form>\n          </div>\n        )}\n        </div>\n        </div>\n      );\n    };\n    export default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}